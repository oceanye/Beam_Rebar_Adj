<Window x:Class="TeklaRebarAdjuster.MainWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:local="clr-namespace:TeklaRebarAdjuster"
        Title="Tekla钢筋端点调整工具 V1.2" Height="450" Width="650"
        Topmost="True"
        WindowStartupLocation="CenterScreen">
    <Window.InputBindings>
        <KeyBinding Key="Space" Command="{Binding ElementName=btnSelectPoint, Path=Command}"/>
        <KeyBinding Key="Return" Command="{Binding ElementName=btnAdjustEndpoints, Path=Command}"/>
    </Window.InputBindings>
    <Grid>
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="*"/>
            <RowDefinition Height="Auto"/>
        </Grid.RowDefinitions>

        <!-- 主操作按钮面板 -->
        <DockPanel Grid.Row="0" LastChildFill="False" Margin="10,5">
            <!-- 左侧主要操作按钮组 -->
            <StackPanel DockPanel.Dock="Left" Orientation="Horizontal" Margin="0,0,10,0">
                <Button x:Name="btnSelectRebars" Content="选择钢筋" Style="{StaticResource {x:Static ToolBar.ButtonStyleKey}}"
                        Margin="0,0,5,0" Padding="10,5" MinWidth="80" Click="BtnSelectRebars_Click"
                        ToolTip="选择需要调整的钢筋"/>
                <Button x:Name="btnSelectPoint" Content="选择点 (Space)" Style="{StaticResource {x:Static ToolBar.ButtonStyleKey}}"
                        Margin="5,0" Padding="10,5" MinWidth="80" Click="BtnSelectPoint_Click" IsEnabled="False"
                        ToolTip="选择调整的目标点 (快捷键: Space)"/>
                <Button x:Name="btnAdjustEndpoints" Content="调整端点 (Enter)" Style="{StaticResource {x:Static ToolBar.ButtonStyleKey}}"
                        Margin="5,0" Padding="10,5" MinWidth="80" Click="BtnAdjustEndpoints_Click" IsEnabled="False"
                        ToolTip="执行端点调整 (快捷键: Enter)"/>
            </StackPanel>
            
            <!-- 右侧辅助功能按钮组 -->
            <StackPanel DockPanel.Dock="Right" Orientation="Horizontal" Margin="10,0,0,0">
                <Button x:Name="btnSelectColinear" Content="选择共线钢筋" Style="{StaticResource {x:Static ToolBar.ButtonStyleKey}}"
                        Margin="5,0" Padding="10,5" MinWidth="80" Click="BtnSelectColinear_Click"
                        ToolTip="自动选择所有共线的钢筋"/>
                <Button x:Name="btnMerge" Content="合并钢筋" Style="{StaticResource {x:Static ToolBar.ButtonStyleKey}}"
                        Margin="5,0" Padding="10,5" MinWidth="80" Click="BtnMerge_Click" IsEnabled="False"
                        ToolTip="合并选中的钢筋"/>
                <Button x:Name="btnAttachToAssembly" Content="附加到构件" Style="{StaticResource {x:Static ToolBar.ButtonStyleKey}}"
                        Margin="5,0" Padding="10,5" MinWidth="80" Click="BtnAttachToAssembly_Click"
                        ToolTip="将钢筋附加到当前构件" IsEnabled="False" Visibility="Collapsed"/>
                <Button x:Name="btnReset" Content="重置" Style="{StaticResource {x:Static ToolBar.ButtonStyleKey}}"
                        Margin="5,0,0,0" Padding="10,5" MinWidth="80" Click="BtnReset_Click"
                        ToolTip="重置所有选择和设置"/>
            </StackPanel>
        </DockPanel>

        <!-- 参数设置面板 -->
        <Grid Grid.Row="1" Margin="10,0,10,10">
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="Auto"/>
                <ColumnDefinition Width="Auto"/>
                <ColumnDefinition Width="Auto"/>
                <ColumnDefinition Width="Auto"/>
                <ColumnDefinition Width="Auto"/>
                <ColumnDefinition Width="Auto"/>
            </Grid.ColumnDefinitions>

            <StackPanel Grid.Column="0" Orientation="Horizontal" Margin="0,0,15,0">
                <TextBlock Text="间隙值:" VerticalAlignment="Center"/>
                <TextBox x:Name="txtGap" Width="60" Margin="5,0" VerticalContentAlignment="Center" Text="0"/>
                <TextBlock Text="mm" VerticalAlignment="Center"/>
            </StackPanel>

            <StackPanel Grid.Column="1" Orientation="Horizontal" Margin="0,0,15,0">
                <TextBlock Text="左右容差:" VerticalAlignment="Center"/>
                <TextBox x:Name="txtOffset" Width="60" Margin="5,0" VerticalContentAlignment="Center" Text="50"/>
                <TextBlock Text="mm" VerticalAlignment="Center"/>
            </StackPanel>

            <StackPanel Grid.Column="2" Orientation="Horizontal" Margin="0,0,15,0">
                <TextBlock Text="过滤规格:" VerticalAlignment="Center"/>
                <TextBox x:Name="txtFilter" Width="100" Margin="5,0" VerticalContentAlignment="Center" Text="PL8*120"/>
            </StackPanel>

            <TextBlock Grid.Column="3" Text="（输入正值创建间隙，0表示无间隙）" 
                       VerticalAlignment="Center" Foreground="Gray"/>
        </Grid>

        <!-- 日志面板 - 替换TextBlock为TextBox以支持复制 -->
        <ScrollViewer Grid.Row="2" Margin="10" x:Name="scrollViewer">
            <TextBox x:Name="txtStatus" TextWrapping="Wrap" Margin="5" FontFamily="Consolas" 
                    IsReadOnly="True" VerticalScrollBarVisibility="Auto" Background="Transparent"
                    BorderThickness="0" AcceptsReturn="True"/>
        </ScrollViewer>

        <!-- 状态栏 -->
        <Border Grid.Row="3" Background="LightGray" BorderBrush="DarkGray" BorderThickness="0,1,0,0">
            <TextBlock x:Name="txtStatusBar" Text="准备就绪" Margin="10,5" HorizontalAlignment="Left" VerticalAlignment="Center"/>
        </Border>
    </Grid>
</Window>