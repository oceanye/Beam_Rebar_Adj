<Window x:Class="TeklaRebarAdjuster.MainWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:local="clr-namespace:TeklaRebarAdjuster"
        Title="Tekla钢筋端点调整工具 V1.2" Height="450" Width="650"
        Topmost="True"
        WindowStartupLocation="CenterScreen">
    <Window.InputBindings>
        <KeyBinding Key="Space" Command="{Binding ElementName=btnSelectPoint, Path=Command}"/>
        <KeyBinding Key="Return" Command="{Binding ElementName=btnAdjustEndpoints, Path=Command}"/>
    </Window.InputBindings>
    <Grid>
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="*"/>
            <RowDefinition Height="Auto"/>
        </Grid.RowDefinitions>

        <!-- 主操作按钮面板 -->
        <Grid Grid.Row="0" Margin="10">
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="Auto"/>
                <ColumnDefinition Width="Auto"/>
                <ColumnDefinition Width="Auto"/>
                <ColumnDefinition Width="Auto"/>
                <ColumnDefinition Width="*"/>
            </Grid.ColumnDefinitions>

            <StackPanel Grid.Column="0" Orientation="Horizontal" Margin="0,0,15,0">
                <Button x:Name="btnSelectRebars" Content="选择钢筋" Style="{StaticResource {x:Static ToolBar.ButtonStyleKey}}" Width="80" Click="BtnSelectRebars_Click"/>
                <Button x:Name="btnSelectPoint" Content="选择点 (Space)" Style="{StaticResource {x:Static ToolBar.ButtonStyleKey}}" Width="80" Margin="5,0" Click="BtnSelectPoint_Click" IsEnabled="False" ToolTip="选择调整的目标点 (快捷键: Space)"/>
            </StackPanel>

            <StackPanel Grid.Column="1" Orientation="Horizontal" Margin="0,0,15,0">
                <Button x:Name="btnAdjustEndpoints" Content="调整端点 (Enter)" Style="{StaticResource {x:Static ToolBar.ButtonStyleKey}}" Width="80" Click="BtnAdjustEndpoints_Click" IsEnabled="False" ToolTip="执行端点调整 (快捷键: Enter)"/>
                <Button x:Name="btnMerge" Content="合并钢筋" Style="{StaticResource {x:Static ToolBar.ButtonStyleKey}}" Width="80" Margin="5,0" Click="BtnMerge_Click" IsEnabled="False" ToolTip="合并选中的钢筋"/>
            </StackPanel>

            <StackPanel Grid.Column="2" Orientation="Horizontal" Margin="0,0,15,0">
                <TextBlock Text="过滤规格:" VerticalAlignment="Center"/>
                <TextBox x:Name="txtFilter" Width="100" Margin="5,0" VerticalContentAlignment="Center" Text="PL8*120"/>
            </StackPanel>

            <StackPanel Grid.Column="3" Orientation="Horizontal" Margin="0,0,15,0">
                <TextBlock Text="间距：" VerticalAlignment="Center"/>
                <TextBox x:Name="txtGap" Width="50" Margin="5,0" VerticalContentAlignment="Center" Text="50"/>
                <TextBlock Text="mm" VerticalAlignment="Center" Margin="5,0"/>
                <CheckBox x:Name="chkAddWeldingRebar" Content="增加焊接钢筋" Margin="10,0,0,0" VerticalAlignment="Center" IsChecked="False" ToolTip="在间隙处增加水平焊接钢筋"/>
                <CheckBox x:Name="chkVerticalWeldingRebar" Content="垂直布置焊接钢筋" Margin="10,0,0,0" VerticalAlignment="Center" IsChecked="False" ToolTip="垂直布置焊接钢筋"/>
                <TextBlock Text="长度：" VerticalAlignment="Center" Margin="10,0,0,0"/>
                <TextBox x:Name="txtWeldingLength" Width="50" Margin="5,0" VerticalContentAlignment="Center" Text="80"/>
                <TextBlock Text="mm" VerticalAlignment="Center" Margin="5,0"/>
                <CheckBox x:Name="chkUseRebarGroup" Content="采用钢筋组" Margin="10,0,0,0" VerticalAlignment="Center" IsChecked="False" ToolTip="采用钢筋组"/>
            </StackPanel>

            <TextBlock Grid.Column="4" Text="（输入正值创建间隙，0表示无间隙）" VerticalAlignment="Center" Foreground="Gray"/>
        </Grid>

        <!-- 参数设置面板 -->
        <Grid Grid.Row="1" Margin="10,0,10,10">
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="Auto"/>
                <ColumnDefinition Width="Auto"/>
                <ColumnDefinition Width="Auto"/>
                <ColumnDefinition Width="Auto"/>
                <ColumnDefinition Width="*"/>
            </Grid.ColumnDefinitions>

            <StackPanel Grid.Column="0" Orientation="Horizontal" Margin="0,0,15,0">
                <TextBlock Text="左右容差:" VerticalAlignment="Center"/>
                <TextBox x:Name="txtOffset" Width="60" Margin="5,0" VerticalContentAlignment="Center" Text="50"/>
                <TextBlock Text="mm" VerticalAlignment="Center"/>
            </StackPanel>

            <Button x:Name="btnSelectColinear" Content="选择共线钢筋" Grid.Column="1" Margin="5,0" Width="100" Click="BtnSelectColinear_Click"/>
            <Button x:Name="btnAttachToAssembly" Content="附加到构件" Grid.Column="2" Margin="5,0" Width="100" Click="BtnAttachToAssembly_Click" IsEnabled="False"/>
            <Button x:Name="btnReset" Content="重置" Grid.Column="3" Margin="5,0" Width="80" Click="BtnReset_Click"/>
        </Grid>

        <!-- 日志面板 - 替换TextBlock为TextBox以支持复制 -->
        <ScrollViewer Grid.Row="2" Margin="10" x:Name="scrollViewer">
            <TextBox x:Name="txtStatus" TextWrapping="Wrap" Margin="5" FontFamily="Consolas" 
                    IsReadOnly="True" VerticalScrollBarVisibility="Auto" Background="Transparent"
                    BorderThickness="0" AcceptsReturn="True"/>
        </ScrollViewer>

        <!-- 状态栏 -->
        <Border Grid.Row="3" Background="LightGray" BorderBrush="DarkGray" BorderThickness="0,1,0,0">
            <TextBlock x:Name="txtStatusBar" Text="准备就绪" Margin="10,5" HorizontalAlignment="Left" VerticalAlignment="Center"/>
        </Border>
    </Grid>
</Window>